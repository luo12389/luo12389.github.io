var AssetAdapter=function(){function e(){}var t=(__define,e),a=t.prototype;return a.getAsset=function(e,t,a){function s(s){t.call(a,s,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?s(i):RES.getResAsync(e,s,this)}else RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var ViewManager=function(e){function t(){e.call(this),this.init()}__extends(t,e);var a=(__define,t),s=a.prototype;return s.init=function(){this.loadingScene=new Loading,this.addChild(this.loadingScene),this.loadingScene.startLoadingGameResource(),this.addEventListener(ChangeSceneEvent.CHANGE_SCENE_EVENT,this.onChangeScene,this)},t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},s.onChangeScene=function(e){switch(this.removeChildren(),e.eventType){case Start.STARTRUN:this.addChild(new Start);break;case Game.GAMERUN:this.addChild(new Game)}},t}(egret.Sprite);egret.registerClass(ViewManager,"ViewManager");var ChangeSceneEvent=function(e){function t(t,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1),e.call(this,t,a,s)}__extends(t,e);var a=(__define,t);a.prototype;return t.CHANGE_SCENE_EVENT="ChangeSceneEvent",t}(egret.Event);egret.registerClass(ChangeSceneEvent,"ChangeSceneEvent");var Main=function(e){function t(){e.apply(this,arguments),this.stageHeight=852,this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var a=(__define,t),s=a.prototype;return s.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},s.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},s.onResourceLoadComplete=function(e){"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},s.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},s.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},s.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},s.onResourceProgress=function(e){"preload"==e.groupName},s.startCreateScene=function(){this.addChild(ViewManager.getInstance())},t}(eui.UILayer);egret.registerClass(Main,"Main");var Moneky=function(e){function t(){e.call(this),this.ratio=.99;var t=new egret.Bitmap(RES.getRes("gameMonkey_png"));this.addChild(t);var a=new egret.Bitmap(RES.getRes("peachHeart_png"));a.scaleX=.6,a.scaleY=.6,a.x=60,a.y=5,a.alpha=0,this.addChild(a);var s=new egret.Bitmap(RES.getRes("peachHeart_png"));s.scaleX=1,s.scaleY=1,s.alpha=0,s.x=68,s.y=-5,this.addChild(s);var i=new egret.Bitmap(RES.getRes("peachHeart_png"));i.scaleX=1.4,i.scaleY=1.4,i.x=80,i.y=-18,i.alpha=0,this.addChild(i)}__extends(t,e);var a=(__define,t);a.prototype;return t}(egret.Sprite);egret.registerClass(Moneky,"Moneky");var Game=function(e){function t(){e.call(this),this.monkeyArray=[],this.gameState=1,this.interval=0,this.firstTime=0,this.secondTime=0,this.thirdTime=0,this.skinName="resource/skins/gameSkin.exml";var t=RES.getRes("curtain_json"),a=RES.getRes("curtain_png"),s=new egret.MovieClipDataFactory(t,a);this.curtainMC=new egret.MovieClip(s.generateMovieClipData("curtain")),this.curtainMC.y=82,this.curtainMC.addEventListener(egret.MovieClipEvent.COMPLETE,this.layOut,this),this.addChild(this.curtainMC),this.curtainMC.touchEnabled=!0,this.curtainMC.play()}__extends(t,e);var a=(__define,t),s=a.prototype;return s.layOut=function(){this.beauty=new egret.Bitmap(RES.getRes("gameWoman_png")),this.beauty.x=320,this.beauty.y=557,this.beauty.touchEnabled=!1,this.beauty.anchorOffsetX=24,this.beauty.anchorOffsetY=62,this.addChild(this.beauty);var e=new Moneky;e.x=140,e.y=130,this.addChild(e),this.monkeyArray.push(e),this.gray=new egret.Bitmap(RES.getRes("gray_png")),this.gray.touchEnabled=!1,this.addChild(this.gray),this.click=new egret.Bitmap(RES.getRes("click_png")),this.click.x=this.beauty.x,this.click.y=this.beauty.y,this.click.touchEnabled=!1,this.click.anchorOffsetX=45,this.click.anchorOffsetY=45,this.addChild(this.click),this.hand=new egret.Bitmap(RES.getRes("gameHand_png")),this.hand.x=this.beauty.x,this.hand.y=this.beauty.y,this.hand.touchEnabled=!1,this.addChild(this.hand),this.playInfo=new egret.Bitmap(RES.getRes("howToPlay_png")),this.playInfo.x=(640-this.playInfo.width)/2,this.playInfo.y=700,this.playInfo.touchEnabled=!1,this.addChild(this.playInfo),egret.Tween.get(this.click,{loop:!0}).set({alpha:1}).to({scaleX:.8,scaleY:.8},500,egret.Ease.quartOut).to({scaleX:1,scaleY:1},500).to({scaleX:.8,scaleY:.8},500,egret.Ease.quartOut).to({scaleX:1,scaleY:1,alpha:0},1e3,egret.Ease.quartInOut).wait(500),this.curtainMC.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.gameStart,this),this.curtainMC.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.beautyMove,this)},s.gameStart=function(e){this.judgeDistances(e.stageX,e.stageY)&&this.gameState&&(this.gray.alpha=0,this.removeChild(this.hand),this.removeChild(this.click),this.removeChild(this.playInfo),this.gameState=0,this.timer=new egret.Timer(50,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.monKeyMove,this),this.timer.start())},s.judgeDistances=function(e,t){var a=Math.sqrt((e-this.beauty.x)*(e-this.beauty.x)+(t-this.beauty.y)*(t-this.beauty.y));return 120>a?!0:!1},s.beautyMove=function(e){if(this.judgeDistances(e.stageX,e.stageY)){var t=this.checkPoint(e.stageX,e.stageY);this.beauty.x=t[0],this.beauty.y=t[1]}},s.monKeyMove=function(){this.interval++;for(var e=0;e<this.monkeyArray.length;e++){var t=this.monkeyArray[e];if(20==this.interval){if(0==e&&this.firstTime++,t.ratio=t.ratio-.01,10==this.firstTime){var a=new Moneky,s=this.setMonkeyPosition();a.x=s[0],a.y=s[1],this.monkeyArray.push(a),this.addChild(a),this.firstTime=0,this.secondTime++}6==this.secondTime&&(this.secondTime=0,this.thirdTime++),this.playTime.text="0"+this.thirdTime.toString()+":"+this.secondTime.toString()+this.firstTime.toString(),e==this.monkeyArray.length-1&&(this.interval=0)}(t.hitTestPoint(this.beauty.x-24,this.beauty.y-62)||t.hitTestPoint(this.beauty.x+24,this.beauty.y-62)||t.hitTestPoint(this.beauty.x-24,this.beauty.y+62)||t.hitTestPoint(this.beauty.x+24,this.beauty.y+62))&&this.gameOver(),t.x=this.lerpDistance(this.beauty.x,t.x,t.ratio),t.y=this.lerpDistance(this.beauty.y,t.y,t.ratio)}},s.checkPoint=function(e,t){return 24>e&&(e=24),e>614&&(e=614),t>968&&(t=968),160>t&&(t=160),[e,t]},s.gameOver=function(){this.timer.stop(),this.gray.alpha=1;var e=new egret.Bitmap(RES.getRes("score_png"));e.x=(640-e.width)/2,e.y=150,this.addChild(e);var t=new eui.Label;t.text=this.playTime.text,t.x=357,t.y=285,t.size=35,t.textColor=16067328,this.addChild(t);var a=new egret.Bitmap(RES.getRes("again_png"));a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.again,this),a.touchEnabled=!0,a.x=100,a.y=700,this.addChild(a);var s=new egret.Bitmap(RES.getRes("share_png"));s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),s.touchEnabled=!0,s.x=364,s.y=700,this.addChild(s)},s.share=function(){var e=new egret.Bitmap(RES.getRes("arrows_png"));e.x=450,e.y=0,this.addChild(e)},s.again=function(){var e=new ChangeSceneEvent(ChangeSceneEvent.CHANGE_SCENE_EVENT);e.eventType=t.GAMERUN,e.obj=this,ViewManager.getInstance().onChangeScene(e)},s.lerpDistance=function(e,t,a){var s=t-e;return Math.round(e+s*a)},s.setMonkeyPosition=function(){var e=0,t=0;return Math.round(2)>1?(e=Math.floor(560*Math.random()+40),t=Math.round(2)>1?140:990,(40==e||600==e)&&(t=Math.floor(850*Math.random()+140))):(e=Math.round(2)>1?40:600,t=Math.floor(850*Math.random()+140),(140==t||990==t)&&(e=Math.floor(560*Math.random()+40))),[e,t]},t.GAMERUN="GameRun",t}(eui.Component);egret.registerClass(Game,"Game");var Loading=function(e){function t(){e.call(this),this.init()}__extends(t,e);var a=(__define,t),s=a.prototype;return s.init=function(){var e=new egret.Bitmap(RES.getRes("loadingBg_png"));this.addChild(e);var t=463;this.hhhProGressBar=new LCProgressBar("progressBg_png","progressBar_png"),this.addChild(this.hhhProGressBar),this.hhhProGressBar.x=(egret.MainContext.instance.stage.stageWidth-t)/2,this.hhhProGressBar.y=370;var a=new egret.Bitmap(RES.getRes("loadingText_png"));a.x=(egret.MainContext.instance.stage.stageWidth-a.width)/2,a.y=400,this.addChild(a);var s=RES.getRes("monkey_png"),i=RES.getRes("monkey_json"),n=new egret.MovieClipDataFactory(i,s);this.monkeyMC=new egret.MovieClip(n.generateMovieClipData("monkey")),this.monkeyMC.x=(egret.MainContext.instance.stage.stageWidth-this.monkeyMC.width)/2,this.monkeyMC.y=250,this.addChild(this.monkeyMC),this.monkeyMC.gotoAndPlay(1,-1),this.monkeyMC.gotoAndPlay(1,-1)},s.startLoadingGameResource=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.gameGroupLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.gameGroupLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.gameGroupProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.gameGroupItemLoadError,this),RES.loadGroup("game")},s.gameGroupLoadComplete=function(e){"game"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.gameGroupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.gameGroupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.gameGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.gameGroupItemLoadError,this),this.toNextScene())},s.gameGroupLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.gameGroupLoadComplete(e)},s.gameGroupProgress=function(e){"game"==e.groupName&&this.hhhProGressBar.setProgress(e.itemsLoaded/e.itemsTotal)},s.gameGroupItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},s.toNextScene=function(){var e=new ChangeSceneEvent(ChangeSceneEvent.CHANGE_SCENE_EVENT);e.eventType=Start.STARTRUN,e.obj=this,ViewManager.getInstance().onChangeScene(e)},t}(eui.Component);egret.registerClass(Loading,"Loading");var Start=function(e){function t(){e.call(this),this.musicState=0,this.time=0,this.skinName="resource/skins/startSkin.exml",this.bgMusic=RES.getRes("bMusic_mp3"),this.init()}__extends(t,e);var a=(__define,t),s=a.prototype;return s.init=function(){var e=this;this.complete(),this.music.addEventListener(egret.TouchEvent.TOUCH_TAP,this.musicSwitch,this);var t=RES.getRes("woman_json"),a=RES.getRes("woman_png"),s=new egret.MovieClipDataFactory(t,a);this.wmMC=new egret.MovieClip(s.generateMovieClipData("woman")),this.wmMC.x=320,this.wmMC.y=270+this.wmMC.height/2,this.wmMC.anchorOffsetX=this.wmMC.width/2,this.wmMC.anchorOffsetY=this.wmMC.height/2,this.wmMC.scaleX=0,this.wmMC.scaleY=0,this.addChildAt(this.wmMC,6),egret.Tween.get(this.wmMC).to({scaleX:1.2,scaleY:1.2},400,egret.Ease.quadOut).to({scaleX:1,scaleY:1},400,egret.Ease.quadOut),egret.Tween.get(this.hand2).to({scaleX:1.2,scaleY:1.2},400,egret.Ease.quadOut).to({scaleX:1,scaleY:1},400,egret.Ease.quadOut),egret.Tween.get(this.hand1).to({scaleX:1.2,scaleY:1.2},400,egret.Ease.quadOut).to({scaleX:1,scaleY:1},400,egret.Ease.quadOut).call(function(){egret.Tween.get(e.hand1,{loop:!0}).to({y:540},200).call(function(){e.wmMC.gotoAndStop(2)}).to({y:504},200).call(function(){e.wmMC.gotoAndStop(1)}),egret.Tween.get(e.hand2,{loop:!0}).to({y:540},200).to({y:504},200),e.titleShow()})},s.complete=function(){var e=this,t=new egret.Bitmap(RES.getRes("stageLight_png"));t.x=(640-t.width)/2,t.y=820,t.alpha=.5,this.addChild(t),egret.Tween.get(t,{loop:!0}).to({alpha:1},500,egret.Ease.quintOut).wait(500).to({alpha:.5},500),egret.Tween.get(this.light).to({rotation:-5},1500,egret.Ease.quadInOut).call(function(){egret.Tween.get(e.light,{loop:!0}).to({rotation:5,alpha:.5},2e3,egret.Ease.quadInOut).to({rotation:-5,alpha:1},2e3,egret.Ease.quadInOut)}),egret.Tween.get(this.star).to({alpha:.5},2e3).call(function(){e.star.alpha=.5,egret.Tween.get(e.star,{loop:!0}).to({alpha:1},800,egret.Ease.quintIn).wait(500).to({alpha:.5},800)})},s.titleShow=function(){var e=this;egret.Tween.get(this.startGroup).to({y:450},400,egret.Ease.quadOut).to({y:150},400,egret.Ease.quadOut).to({y:330},300,egret.Ease.quadOut).call(function(){egret.Tween.get(e.head).to({scaleX:1,scaleY:1},500),egret.Tween.get(e.lip).to({scaleX:.8,scaleY:.8},500),egret.Tween.get(e.parts).to({scaleX:.8,scaleY:.8},500)}).to({y:300},300,egret.Ease.quadOut).to({y:310},250,egret.Ease.quadOut).wait(500).call(function(){egret.Tween.get(e.startGroup,{loop:!0}).to({y:295},1500,egret.Ease.sineInOut).call(function(){egret.Tween.get(e.head).to({rotation:-5},200,egret.Ease.quadInOut).call(function(){egret.Tween.get(e.head).to({rotation:5},200,egret.Ease.quadInOut).to({rotation:-5},200,egret.Ease.quadInOut).to({rotation:5},200,egret.Ease.quadInOut).to({rotation:-5},200,egret.Ease.quadInOut)}),egret.Tween.get(e.lip).to({scaleX:1,scaleY:1},400,egret.Ease.quintOut).to({scaleX:.8,scaleY:.8},400),egret.Tween.get(e.parts).to({scaleX:1,scaleY:1},125,egret.Ease.quadIn).to({scaleX:.8,scaleY:.8},125,egret.Ease.quadIn).to({scaleX:1,scaleY:1},125,egret.Ease.quadIn).to({scaleX:.8,scaleY:.8},125,egret.Ease.quadIn).to({scaleX:1,scaleY:1},125,egret.Ease.quadIn).to({scaleX:.8,scaleY:.8},125,egret.Ease.quadIn)}).to({y:310},1500,egret.Ease.sineInOut),e.startBtn.touchEnabled=!1,egret.Tween.get(e.startBtn).to({scaleX:1,scaleY:1},1e3).call(function(){var t=new egret.Bitmap(RES.getRes("startLight_png"));t.x=(640-t.width)/2-5,t.y=905,e.addChild(t),egret.Tween.get(t,{loop:!0}).to({alpha:.4},500,egret.Ease.quintOut).to({alpha:1},500,egret.Ease.quintOut).wait(500),e.startBtn.touchEnabled=!0}),e.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.toNextScene,e)})},s.toNextScene=function(){if(this.startBtn.hasEventListener(egret.TouchEvent.TOUCH_TAP)){this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.toNextScene,this);var e=new ChangeSceneEvent(ChangeSceneEvent.CHANGE_SCENE_EVENT);e.eventType=Game.GAMERUN,e.obj=this,ViewManager.getInstance().onChangeScene(e)}},s.musicSwitch=function(){this.musicState?(egret.Tween.removeTweens(this.music),egret.Tween.get(this.music).set({rotation:0}),this.soundChannel.stop(),this.musicState=0):(egret.Tween.get(this.music,{loop:!0}).to({rotation:360},3e3),this.soundChannel=this.bgMusic.play(),this.musicState=1)},t.STARTRUN="StartRun",t}(eui.Component);egret.registerClass(Start,"Start");var ThemeAdapter=function(){function e(){}var t=(__define,e),a=t.prototype;return a.getTheme=function(e,t,a,s){function i(e){t.call(s,e)}function n(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),a.call(s))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,n,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var LCProgressBar=function(e){function t(t,a){e.call(this),this.bg=new egret.Bitmap(RES.getRes(t)),this.addChild(this.bg),this.bar=new egret.Bitmap(RES.getRes(a)),this.addChild(this.bar),this.barMask=new egret.Rectangle(0,0,0,this.bar.width),this.bar.mask=this.barMask}__extends(t,e);var a=(__define,t),s=a.prototype;return s.setProgress=function(e){this.barMask=new egret.Rectangle(0,0,e*this.bar.width,this.bar.height),this.bar.mask=this.barMask},t}(egret.Sprite);egret.registerClass(LCProgressBar,"LCProgressBar");