var __reflect=this&&this.__reflect||function(e,t,a){e.__class__=t,a?a.push(t):a=[t],e.__types__=e.__types__?a.concat(e.__types__):a},__extends=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,a){function n(n){t.call(a,n,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?n(r):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ViewManager=function(e){function t(){var t=e.call(this)||this;t.init();var a,n=RES.getRes("bgMusic_mp3");return a=n.play(),a.stop(),t}return __extends(t,e),t.prototype.init=function(){this.loadingScene=new Loading,this.addChild(this.loadingScene),this.loadingScene.startLoadingGameResource(),this.addEventListener(ChangeSceneEvent.CHANGE_SCENE_EVENT,this.onChangeScene,this)},t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.onChangeScene=function(e){switch(this.removeChildren(),e.eventType){case Start.STARTRUN:this.addChild(new Start);break;case Game.GAMERUN:this.addChild(new Game)}},t}(egret.Sprite);__reflect(ViewManager.prototype,"ViewManager");var ChangeSceneEvent=function(e){function t(t,a,n){return void 0===a&&(a=!1),void 0===n&&(n=!1),e.call(this,t,a,n)||this}return __extends(t,e),t}(egret.Event);ChangeSceneEvent.CHANGE_SCENE_EVENT="ChangeSceneEvent",__reflect(ChangeSceneEvent.prototype,"ChangeSceneEvent");var Main=function(e){function t(){var t=e.apply(this,arguments)||this;return t.stageHeight=852,t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName},t.prototype.startCreateScene=function(){this.addChild(ViewManager.getInstance())},t}(eui.UILayer);__reflect(Main.prototype,"Main");var Moneky=function(e){function t(){var t=e.call(this)||this;t.ratio=.99;var a=new egret.Bitmap(RES.getRes("gameMonkey_png"));t.addChild(a);var n=new egret.Bitmap(RES.getRes("peachHeart_png"));n.scaleX=.6,n.scaleY=.6,n.x=60,n.y=5,n.alpha=0,t.addChild(n);var r=new egret.Bitmap(RES.getRes("peachHeart_png"));r.scaleX=1,r.scaleY=1,r.alpha=0,r.x=68,r.y=-5,t.addChild(r);var s=new egret.Bitmap(RES.getRes("peachHeart_png"));return s.scaleX=1.4,s.scaleY=1.4,s.x=80,s.y=-18,s.alpha=0,t.addChild(s),t}return __extends(t,e),t}(egret.Sprite);__reflect(Moneky.prototype,"Moneky");var Game=function(e){function t(){var t=e.call(this)||this;t.monkeyArray=[],t.gameState=1,t.interval=0,t.firstTime=0,t.secondTime=0,t.thirdTime=0,t.skinName="resource/skins/gameSkin.exml";var a=RES.getRes("curtain_json"),n=RES.getRes("curtain_png"),r=new egret.MovieClipDataFactory(a,n);return t.curtainMC=new egret.MovieClip(r.generateMovieClipData("curtain")),t.curtainMC.y=82,t.curtainMC.addEventListener(egret.MovieClipEvent.COMPLETE,t.layOut,t),t.addChild(t.curtainMC),t.curtainMC.touchEnabled=!0,t.curtainMC.play(),t}return __extends(t,e),t.prototype.layOut=function(){this.beauty=new egret.Bitmap(RES.getRes("gameWoman_png")),this.beauty.x=320,this.beauty.y=557,this.beauty.touchEnabled=!1,this.beauty.anchorOffsetX=24,this.beauty.anchorOffsetY=62,this.addChild(this.beauty);var e=new Moneky;e.x=140,e.y=130,this.addChild(e),this.monkeyArray.push(e),this.gray=new egret.Bitmap(RES.getRes("gray_png")),this.gray.touchEnabled=!1,this.addChild(this.gray),this.click=new egret.Bitmap(RES.getRes("click_png")),this.click.x=this.beauty.x,this.click.y=this.beauty.y,this.click.touchEnabled=!1,this.click.anchorOffsetX=45,this.click.anchorOffsetY=45,this.addChild(this.click),this.hand=new egret.Bitmap(RES.getRes("gameHand_png")),this.hand.x=this.beauty.x,this.hand.y=this.beauty.y,this.hand.touchEnabled=!1,this.addChild(this.hand),this.playInfo=new egret.Bitmap(RES.getRes("howToPlay_png")),this.playInfo.x=(640-this.playInfo.width)/2,this.playInfo.y=700,this.playInfo.touchEnabled=!1,this.addChild(this.playInfo),egret.Tween.get(this.click,{loop:!0}).set({alpha:1}).to({scaleX:.8,scaleY:.8},500,egret.Ease.quartOut).to({scaleX:1,scaleY:1},500).to({scaleX:.8,scaleY:.8},500,egret.Ease.quartOut).to({scaleX:1,scaleY:1,alpha:0},1e3,egret.Ease.quartInOut).wait(500),this.curtainMC.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.gameStart,this),this.curtainMC.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.beautyMove,this)},t.prototype.gameStart=function(e){this.judgeDistances(e.stageX,e.stageY)&&this.gameState&&(this.gray.alpha=0,this.removeChild(this.hand),this.removeChild(this.click),this.removeChild(this.playInfo),this.gameState=0,this.timer=new egret.Timer(50,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.monKeyMove,this),this.timer.start())},t.prototype.judgeDistances=function(e,t){var a=Math.sqrt((e-this.beauty.x)*(e-this.beauty.x)+(t-this.beauty.y)*(t-this.beauty.y));return 120>a?!0:!1},t.prototype.beautyMove=function(e){if(this.judgeDistances(e.stageX,e.stageY)){var t=this.checkPoint(e.stageX,e.stageY);this.beauty.x=t[0],this.beauty.y=t[1]}},t.prototype.monKeyMove=function(){this.interval++;for(var e=0;e<this.monkeyArray.length;e++){var t=this.monkeyArray[e];if(20==this.interval){if(0==e&&this.firstTime++,t.ratio=t.ratio-.01,10==this.firstTime){var a=new Moneky,n=this.setMonkeyPosition();a.x=n[0],a.y=n[1],this.monkeyArray.push(a),this.addChild(a),this.firstTime=0,this.secondTime++}6==this.secondTime&&(this.secondTime=0,this.thirdTime++),this.playTime.text="0"+this.thirdTime.toString()+":"+this.secondTime.toString()+this.firstTime.toString(),e==this.monkeyArray.length-1&&(this.interval=0)}(t.hitTestPoint(this.beauty.x-24,this.beauty.y-62)||t.hitTestPoint(this.beauty.x+24,this.beauty.y-62)||t.hitTestPoint(this.beauty.x-24,this.beauty.y+62)||t.hitTestPoint(this.beauty.x+24,this.beauty.y+62))&&this.gameOver(),t.x=this.lerpDistance(this.beauty.x,t.x,t.ratio),t.y=this.lerpDistance(this.beauty.y,t.y,t.ratio)}},t.prototype.checkPoint=function(e,t){return 24>e&&(e=24),e>614&&(e=614),t>968&&(t=968),160>t&&(t=160),[e,t]},t.prototype.gameOver=function(){this.timer.stop(),this.gray.alpha=1;var e=new egret.Bitmap(RES.getRes("score_png"));e.x=(640-e.width)/2,e.y=150,this.addChild(e);var t=new eui.Label;t.text=this.playTime.text,t.x=357,t.y=285,t.size=35,t.textColor=16067328,this.addChild(t);var a=new egret.Bitmap(RES.getRes("again_png"));a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.again,this),a.touchEnabled=!0,a.x=100,a.y=700,this.addChild(a);var n=new egret.Bitmap(RES.getRes("share_png"));n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.share,this),n.touchEnabled=!0,n.x=364,n.y=700,this.addChild(n)},t.prototype.share=function(){var e=new egret.Bitmap(RES.getRes("arrows_png"));e.x=450,e.y=0,this.addChild(e)},t.prototype.again=function(){var e=new ChangeSceneEvent(ChangeSceneEvent.CHANGE_SCENE_EVENT);e.eventType=t.GAMERUN,e.obj=this,ViewManager.getInstance().onChangeScene(e)},t.prototype.lerpDistance=function(e,t,a){var n=t-e;return Math.round(e+n*a)},t.prototype.setMonkeyPosition=function(){var e=0,t=0;return Math.round(2)>1?(e=Math.floor(560*Math.random()+40),t=Math.round(2)>1?140:990,(40==e||600==e)&&(t=Math.floor(850*Math.random()+140))):(e=Math.round(2)>1?40:600,t=Math.floor(850*Math.random()+140),(140==t||990==t)&&(e=Math.floor(560*Math.random()+40))),[e,t]},t}(eui.Component);Game.GAMERUN="GameRun",__reflect(Game.prototype,"Game");var Loading=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){var e=new egret.Bitmap(RES.getRes("loadingBg_png"));this.addChild(e);var t=463;this.hhhProGressBar=new LCProgressBar("progressBg_png","progressBar_png"),this.addChild(this.hhhProGressBar),this.hhhProGressBar.x=(egret.MainContext.instance.stage.stageWidth-t)/2,this.hhhProGressBar.y=370;var a=new egret.Bitmap(RES.getRes("loadingText_png"));a.x=(egret.MainContext.instance.stage.stageWidth-a.width)/2,a.y=400,this.addChild(a);var n=RES.getRes("monkey_png"),r=RES.getRes("monkey_json"),s=new egret.MovieClipDataFactory(r,n);this.monkeyMC=new egret.MovieClip(s.generateMovieClipData("monkey")),this.monkeyMC.x=(egret.MainContext.instance.stage.stageWidth-this.monkeyMC.width)/2,this.monkeyMC.y=250,this.addChild(this.monkeyMC),this.monkeyMC.gotoAndPlay(1,-1),this.monkeyMC.gotoAndPlay(1,-1)},t.prototype.startLoadingGameResource=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.gameGroupLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.gameGroupLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.gameGroupProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.gameGroupItemLoadError,this),RES.loadGroup("game")},t.prototype.gameGroupLoadComplete=function(e){"game"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.gameGroupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.gameGroupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.gameGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.gameGroupItemLoadError,this),this.toNextScene())},t.prototype.gameGroupLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.gameGroupLoadComplete(e)},t.prototype.gameGroupProgress=function(e){"game"==e.groupName&&this.hhhProGressBar.setProgress(e.itemsLoaded/e.itemsTotal)},t.prototype.gameGroupItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.toNextScene=function(){var e=new ChangeSceneEvent(ChangeSceneEvent.CHANGE_SCENE_EVENT);e.eventType=Start.STARTRUN,e.obj=this,ViewManager.getInstance().onChangeScene(e)},t}(eui.Component);__reflect(Loading.prototype,"Loading");var Start=function(e){function t(){var t=e.call(this)||this;return t.time=0,t.skinName="resource/skins/startSkin.exml",t.init(),t}return __extends(t,e),t.prototype.init=function(){var e=this;this.complete();var t=RES.getRes("woman_json"),a=RES.getRes("woman_png"),n=new egret.MovieClipDataFactory(t,a);this.wmMC=new egret.MovieClip(n.generateMovieClipData("woman")),this.wmMC.x=320,this.wmMC.y=270+this.wmMC.height/2,this.wmMC.anchorOffsetX=this.wmMC.width/2,this.wmMC.anchorOffsetY=this.wmMC.height/2,this.wmMC.scaleX=0,this.wmMC.scaleY=0,this.addChildAt(this.wmMC,6),egret.Tween.get(this.wmMC).to({scaleX:1.2,scaleY:1.2},400,egret.Ease.quadOut).to({scaleX:1,scaleY:1},400,egret.Ease.quadOut),egret.Tween.get(this.hand2).to({scaleX:1.2,scaleY:1.2},400,egret.Ease.quadOut).to({scaleX:1,scaleY:1},400,egret.Ease.quadOut),egret.Tween.get(this.hand1).to({scaleX:1.2,scaleY:1.2},400,egret.Ease.quadOut).to({scaleX:1,scaleY:1},400,egret.Ease.quadOut).call(function(){egret.Tween.get(e.hand1,{loop:!0}).to({y:540},200).call(function(){e.wmMC.gotoAndStop(2)}).to({y:504},200).call(function(){e.wmMC.gotoAndStop(1)}),egret.Tween.get(e.hand2,{loop:!0}).to({y:540},200).to({y:504},200),e.titleShow()}),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.musicStart,this)},t.prototype.musicStart=function(){this.bgMusic=RES.getRes("bgMusic_mp3"),this.soundChannel=this.bgMusic.play(),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.musicStart,this),this.touchEnabled=!1},t.prototype.complete=function(){var e=this,t=new egret.Bitmap(RES.getRes("stageLight_png"));t.x=(640-t.width)/2,t.y=820,t.alpha=.5,this.addChild(t),egret.Tween.get(t,{loop:!0}).to({alpha:1},500,egret.Ease.quintOut).wait(500).to({alpha:.5},500),egret.Tween.get(this.light).to({rotation:-5},1500,egret.Ease.quadInOut).call(function(){egret.Tween.get(e.light,{loop:!0}).to({rotation:5,alpha:.5},2e3,egret.Ease.quadInOut).to({rotation:-5,alpha:1},2e3,egret.Ease.quadInOut)}),egret.Tween.get(this.star).to({alpha:.5},2e3).call(function(){e.star.alpha=.5,egret.Tween.get(e.star,{loop:!0}).to({alpha:1},800,egret.Ease.quintIn).wait(500).to({alpha:.5},800)})},t.prototype.titleShow=function(){var e=this;egret.Tween.get(this.startGroup).to({y:450},400,egret.Ease.quadOut).to({y:150},400,egret.Ease.quadOut).to({y:330},300,egret.Ease.quadOut).call(function(){egret.Tween.get(e.head).to({scaleX:1,scaleY:1},500),egret.Tween.get(e.lip).to({scaleX:.8,scaleY:.8},500),egret.Tween.get(e.parts).to({scaleX:.8,scaleY:.8},500)}).to({y:300},300,egret.Ease.quadOut).to({y:310},250,egret.Ease.quadOut).wait(500).call(function(){egret.Tween.get(e.startGroup,{loop:!0}).to({y:295},1500,egret.Ease.sineInOut).call(function(){egret.Tween.get(e.head).to({rotation:-5},200,egret.Ease.quadInOut).call(function(){egret.Tween.get(e.head).to({rotation:5},200,egret.Ease.quadInOut).to({rotation:-5},200,egret.Ease.quadInOut).to({rotation:5},200,egret.Ease.quadInOut).to({rotation:-5},200,egret.Ease.quadInOut)}),egret.Tween.get(e.lip).to({scaleX:1,scaleY:1},400,egret.Ease.quintOut).to({scaleX:.8,scaleY:.8},400),egret.Tween.get(e.parts).to({scaleX:1,scaleY:1},125,egret.Ease.quadIn).to({scaleX:.8,scaleY:.8},125,egret.Ease.quadIn).to({scaleX:1,scaleY:1},125,egret.Ease.quadIn).to({scaleX:.8,scaleY:.8},125,egret.Ease.quadIn).to({scaleX:1,scaleY:1},125,egret.Ease.quadIn).to({scaleX:.8,scaleY:.8},125,egret.Ease.quadIn)}).to({y:310},1500,egret.Ease.sineInOut),e.startBtn.touchEnabled=!1,egret.Tween.get(e.startBtn).to({scaleX:1,scaleY:1},1e3).call(function(){var t=new egret.Bitmap(RES.getRes("startLight_png"));t.x=(640-t.width)/2-5,t.y=905,e.addChild(t),egret.Tween.get(t,{loop:!0}).to({alpha:.4},500,egret.Ease.quintOut).to({alpha:1},500,egret.Ease.quintOut).wait(500),e.startBtn.touchEnabled=!0}),e.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.toNextScene,e)})},t.prototype.toNextScene=function(){if(this.startBtn.hasEventListener(egret.TouchEvent.TOUCH_TAP)){this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.toNextScene,this);var e=new ChangeSceneEvent(ChangeSceneEvent.CHANGE_SCENE_EVENT);e.eventType=Game.GAMERUN,e.obj=this,ViewManager.getInstance().onChangeScene(e)}},t}(eui.Component);Start.STARTRUN="StartRun",__reflect(Start.prototype,"Start");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,a,n){function r(e){t.call(n,e)}function s(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),a.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var LCProgressBar=function(e){function t(t,a){var n=e.call(this)||this;return n.bg=new egret.Bitmap(RES.getRes(t)),n.addChild(n.bg),n.bar=new egret.Bitmap(RES.getRes(a)),n.addChild(n.bar),n.barMask=new egret.Rectangle(0,0,0,n.bar.width),n.bar.mask=n.barMask,n}return __extends(t,e),t.prototype.setProgress=function(e){this.barMask=new egret.Rectangle(0,0,e*this.bar.width,this.bar.height),this.bar.mask=this.barMask},t}(egret.Sprite);__reflect(LCProgressBar.prototype,"LCProgressBar");